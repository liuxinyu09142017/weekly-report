# 增强版工作周报系统 - 部署说明

## 🎉 新增功能

### 1️⃣ **多维度统计分析**

```
✅ 按项目类型统计（售前/售后）
✅ 售前项目细分（已签单/Pipeline）
✅ 按行业统计金额
✅ 按客户统计金额  
✅ 按销售人员统计金额
✅ 客户数和销售人员数统计
```

### 2️⃣ **灵活的日期范围过滤**

```
✅ 开始日期过滤
✅ 结束日期过滤
✅ 可按年度/月份/周进行查询
```

### 3️⃣ **多条件组合筛选**

```
✅ 项目类型筛选（售前/售后）
✅ 签单状态筛选（已签单/Pipeline）
✅ 行业过滤
✅ 客户名称过滤
✅ 销售人员过滤
✅ 支持多条件组合查询
```

### 4️⃣ **完整的统计卡片**

```
卡片显示：
- 总项目金额（包含项目数）
- 售前项目金额（包含项目数）
- 售前已签单金额（包含项目数）
- 售前Pipeline金额（包含项目数）
- 售后项目金额（包含项目数）
- 工作时长（包含工作天数）
- 加班时长（包含加班天数）
- 客户数/销售人员数
```

### 5️⃣ **可视化分析**

```
✅ 按行业分析卡片（显示各行业金额）
✅ 按客户分析卡片（显示各客户金额）
✅ 按销售人员分析卡片（显示各销售人员金额）
```

---

## 📦 部署步骤

### 步骤1️⃣：删除旧文件

```
访问: https://github.com/liuxinyu09142017/weekly-report
点击 "index.html"
点击右上角 "..."
选择 "Delete file"
Commit: Update to enhanced version
提交
```

### 步骤2️⃣：上传新文件

```
点击 "Add file" → "Upload files"
拖拽下载的 weekly_report_feishu.html
★ 改名为 index.html ★
Commit: Add enhanced weekly report system
提交
```

### 步骤3️⃣：等待部署并刷新

```
等待 1-2 分钟
访问: https://liuxinyu09142017.github.io/weekly-report/
按 Ctrl+Shift+Delete 清除缓存
刷新页面
✅ 完成！
```

---

## 🎯 使用示例

### 场景1：查看本月数据

```
1. 开始日期：2026-01-01
2. 结束日期：2026-01-31
3. 点击"应用筛选"
4. 自动统计本月所有项目和时间
```

### 场景2：查看某个销售的已签单项目

```
1. 项目类型：售前
2. 签单状态：已签单
3. 销售人员：输入销售名称
4. 点击"应用筛选"
5. 显示该销售的所有已签单项目及金额
```

### 场景3：分析某个行业的项目分布

```
1. 行业：输入行业名称（如"金融"）
2. 点击"应用筛选"
3. 在"按行业统计金额"卡片中可以看到
4. 该行业各客户的项目分布
```

### 场景4：按年度统计

```
1. 开始日期：2025-01-01
2. 结束日期：2025-12-31
3. 点击"应用筛选"
4. 显示全年统计数据
5. 各卡片自动更新
```

---

## 📊 界面说明

### 上部统计卡片（8个卡片）

| 卡片 | 说明 | 用途 |
|------|------|------|
| 总项目金额 | 所有项目总金额 + 项目数 | 整体项目规模 |
| 售前项目金额 | 所有售前项目金额 + 项目数 | 售前总规模 |
| 售前已签单 | 已签单项目金额 + 项目数 | 确定收入 |
| 售前Pipeline | Pipeline项目金额 + 项目数 | 潜在收入 |
| 售后项目金额 | 所有售后项目金额 + 项目数 | 售后总规模 |
| 工作时长 | 总工作小时 + 工作天数 | 工作量统计 |
| 加班时长 | 总加班小时 + 加班天数 | 加班情况 |
| 客户/销售数 | 不重复计算的客户数和销售人员数 | 人员规模 |

### 中部过滤条件（7个过滤器）

```
1. 开始日期 - 选择查询起点
2. 结束日期 - 选择查询终点
3. 项目类型 - 售前/售后/全部
4. 签单状态 - 已签单/Pipeline/全部
5. 行业 - 输入行业名称
6. 客户 - 输入客户名称
7. 销售人员 - 输入销售人员名称

应用筛选按钮 - 执行过滤
```

### 下部分析卡片（3个卡片）

```
1. 按行业统计金额
   - 显示各行业的项目金额总和
   - 按金额从高到低排序

2. 按客户统计金额
   - 显示各客户的项目金额总和
   - 按金额从高到低排序

3. 按销售人员统计金额
   - 显示各销售人员负责项目的金额总和
   - 按金额从高到低排序
```

---

## 🔄 重置筛选

点击 **"🔄 重置筛选"** 按钮可以：
```
✅ 清除所有过滤条件
✅ 恢复显示所有数据
✅ 重新计算所有统计数据
```

---

## 📥 数据操作

### 导出数据

```
点击 "💾 导出数据"
自动下载 CSV 文件
包含当前筛选后的所有数据
可在 Excel 中打开编辑
```

### 导入数据

```
点击 "📥 导入数据"
选择 CSV 文件
点击导入
数据自动合并到系统
```

---

## 💡 使用技巧

### 技巧1：快速查看某个销售的业绩

```
1. 销售人员：输入销售名称
2. 应用筛选
3. 立即看到该销售的：
   - 总金额
   - 项目数
   - 各项目详情
   - 按行业分布
```

### 技巧2：追踪Pipeline转化

```
1. 项目类型：售前
2. 签单状态：Pipeline
3. 应用筛选
4. 显示所有未签单项目
5. 监控Pipeline金额
```

### 技巧3：年度对比

```
先查询2025年：开始日期2025-01-01，结束日期2025-12-31
记下统计数据

再查询2026年：开始日期2026-01-01，结束日期2026-12-31
对比两年数据
```

### 技巧4：行业专注度分析

```
1. 行业：输入行业名称（如"金融"）
2. 应用筛选
3. 在"按行业统计"卡片中看到该行业所有客户
4. 评估行业集中度
```

---

## ⚡ 快速部署（3步）

```
1️⃣  删除旧 index.html
    GitHub仓库 → 点击 index.html → 右上角... → Delete

2️⃣  上传新文件  
    GitHub仓库 → Add file → Upload files → 拖拽文件 → 改名 index.html

3️⃣  刷新网站
    等待1-2分钟 → 访问你的网站 → Ctrl+Shift+Delete清除缓存 → 刷新
```

---

## ✅ 验证成功

部署完成后，你应该看到：

```
✅ 8个统计卡片在顶部
✅ 7个过滤条件
✅ 3个分析卡片显示按行业/客户/销售人员的统计
✅ 完整的数据表格
✅ 所有按钮都可点击
✅ 中文显示正常
```

---

## 🎓 新手快速上手

### 第1步：添加项目
```
点击 "➕ 添加新项目"
填写必要信息：
- 周起始日期
- 客户名称
- 项目名称
- 行业、国家、规模
- 项目类型（售前/售后）
- 销售人员
- 工作时长/加班时长
点击保存
```

### 第2步：查看总体统计
```
项目添加后自动显示在顶部卡片中
根据不同卡片了解项目分布
```

### 第3步：使用筛选功能
```
设置开始和结束日期
可选地添加其他过滤条件
点击应用筛选
查看筛选后的数据和统计
```

### 第4步：分析数据
```
查看下部的3个分析卡片
了解按行业/客户/销售的分布
做出数据驱动的决策
```

---

## 📞 常见问题

### Q: 筛选后的统计会自动更新吗？
A: 是的。点击"应用筛选"后，所有统计卡片和分析都会自动更新。

### Q: 可以同时用多个过滤条件吗？
A: 完全可以！所有过滤条件都是AND关系，组合使用效果更好。

### Q: 导出的数据包含哪些信息？
A: 包含所有字段，导出的是当前筛选后的数据。

### Q: 如何导入历史数据？
A: 用导出功能导出现有数据，编辑后用导入功能重新导入即可。

### Q: 中文显示还是乱码怎么办？
A: 清除浏览器缓存（Ctrl+Shift+Delete）然后刷新，或用无痕模式。

---

## 🚀 现在就开始使用！

1. 下载 `weekly_report_feishu.html`
2. 按上面的3步部署
3. 立即享受强大的数据分析功能！

祝使用愉快！ 🎊
